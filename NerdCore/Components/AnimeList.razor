@using Microsoft.AspNetCore.Components.Web
@using NerdCore.Models
@using NerdCore.Data
@using NerdCore.Controllers
@inject AnimeService objAnime
@inject NavigationManager NavigationManager



<div class="uk-section-default">
    <div id="test-filter" class="uk-section uk-light uk-background-cover uk-overflow-hidden uk-flex uk-flex-top" uk-parallax="bgy: -100; sepia: 100;" style="background-image: url(../img/AnimeGuestBG.jpg); height: 70vh">
        <div class="uk-width-1-2@m uk-text-center uk-margin-auto uk-margin-auto-vertical" uk-parallax="target: #test-filter; blur: 0,10;">
            <div class="uk-overlay uk-overlay-primary uk-width-medium">
                <h1>Anime</h1>
            </div>
        </div>
    </div>
</div><div class="uk-section-default uk-margin">
    <div class="uk-section">
        <div class=" uk-container">
            <div class="uk-card uk-card-default">
                <div class="uk-card-body uk-overflow-auto">
                    @if (aniObj != null)
                    {
                        <table class="uk-table  uk-table-middle uk-table-divider">
                            <thead>
                                <tr>
                                    <th class="uk-width-medium">Nombre de la Serie</th>
                                    <th>Lanzamiento</th>
                                    <th>Capitulos</th>
                                    <th>Genero</th>
                                    <th>Estado</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var anime in aniObj)
                                {
                                    <tr>
                                        <td>@anime.Nombre</td>
                                        <td class="uk-visible@m"> @anime.Lanzamiento </td>
                                        <td class="uk-visible@m">@anime.Capitulos </td>
                                        <td class="uk-visible@m"> @anime.Genero </td>
                                        <td class="uk-visible@m"> @anime.Estado </td>
                                        <td><a data-toggle="modal" data-target="#animeModal" class="btn--ver uk-button" style="color:white" @onclick="(e => SelectAnime(anime.IdAnime))">ver</a></td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    }
                </div>
            </div>
        </div>
    </div>
</div>



@if (selectedAnime != null)
{
    int ID = @selectedAnime.IdAnime;

    <!--Modal: Anime-->

    <div class="modal fade" id="animeModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
            <div class="modal-content">
                <div class="card bg-dark text-white">
                    <img style="opacity:30%" src="img/anime/@selectedAnime.Imagen" class="card-img" alt="...">
                    <div class="card-img-overlay">
                        <h23 class="">@selectedAnime.Nombre</h23>
                        <p class="card-text">@selectedAnime.Sinopsis</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <a @onclick="(e => MostrarDetalles(ID))" class="btn--detalles uk-button" style="color:white">Ver</a>
                </div>
            </div>
        </div>
    </div>

}

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    @code {

        List<VAnime> aniObj;
protected override async Task OnInitializedAsync()
    {
        aniObj = await Task.Run(() => objAnime.GetAnimes());
    }



    VAnime selectedAnime;
    int selectedAnimeId;

    void SelectAnime(int AnimeId)
    {
        selectedAnimeId = AnimeId;
        selectedAnime = aniObj.First(x => x.IdAnime == AnimeId);
    }

    private void MostrarDetalles(int ID)
    {
        NavigationManager.NavigateTo("Animes/Details/" + ID, true);
    }
    }





